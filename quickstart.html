
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Quickstart &#8212; Scanner 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/readable.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Interactive Jupyter Walkthrough" href="walkthrough.html" />
    <link rel="prev" title="Getting Started" href="getting-started.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="walkthrough.html" title="Interactive Jupyter Walkthrough"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="getting-started.html" title="Getting Started"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Scanner 0.0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="getting-started.html" accesskey="U">Getting Started</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="quickstart">
<span id="id1"></span><h1>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">¶</a></h1>
<p>To explain how Scanner is used, let’s walkthrough a simple example that
reads frames from a video, resizes them, and then creates a new video using
those resized frames.</p>
<div class="section" id="starting-up-scanner">
<h2>Starting up Scanner<a class="headerlink" href="#starting-up-scanner" title="Permalink to this headline">¶</a></h2>
<p>The first step in any Scanner program is to create a <cite>Database</cite> object.
The <cite>Database</cite> object manages videos or other data that you have may have
stored from data processing you’ve done in the past. The Database object also
provides the API to construct and execute new video processing jobs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scannerpy</span> <span class="kn">import</span> <span class="n">Database</span><span class="p">,</span> <span class="n">Job</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">Database</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="ingesting-a-video-into-the-database">
<h2>Ingesting a video into the Database<a class="headerlink" href="#ingesting-a-video-into-the-database" title="Permalink to this headline">¶</a></h2>
<p>Scanner is designed to provide fast access to frames in videos, even under
random access patterns. In order to provide this functionality, Scanner first
needs to analyze the video to build an index on the video. For example, given
an mp4 video named ‘example.mp4’, we can ingest this video as follow:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">ingest_videos</span><span class="p">([(</span><span class="s1">&#39;example_table&#39;</span><span class="p">,</span> <span class="s1">&#39;example.mp4&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<p>Scanner analyzes the file to build the index and creates a <em>table</em> for that
video in the database. You can see the contents of the database by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">summarize</span><span class="p">())</span>
<span class="go">                      ** TABLES **</span>
<span class="go">---------------------------------------------------</span>
<span class="go">ID | Name       | # rows | Columns      | Committed</span>
<span class="go">---------------------------------------------------</span>
<span class="go">0  | table_name | 360    | index, frame | true</span>
</pre></div>
</div>
<p>Scanner can also read videos without copying them using the <cite>inplace</cite> flag.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">ingest_videos</span><span class="p">([(</span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span> <span class="s1">&#39;example.mp4&#39;</span><span class="p">)],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This still builds the index for accessing the video but avoids copying the files
into the database.</p>
</div>
<div class="section" id="defining-a-computation-graph">
<h2>Defining a Computation Graph<a class="headerlink" href="#defining-a-computation-graph" title="Permalink to this headline">¶</a></h2>
<p>Now we can tell Scanner how to process the video by constructing a
<em>computation graph</em>. A computation graph is a graph of input nodes (<em>Sources</em>),
function nodes (<em>Ops</em>), and output nodes (<em>Sinks</em>). Sources can read data from
the database (such as the table we ingested above) or from other sources of
data, such as the filesystem. Ops represent functions that transform their
inputs into new outputs. Sinks, like Sources, write data to the database or to
other forms of persistent storage. Let’s define a computation graph to
read frames from the database, resize them to 640x480 resolution, and then
save them back to a new database table:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">FrameColumn</span><span class="p">()</span>
<span class="n">resized</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">)</span>
<span class="n">output_frame</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">sinks</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;frame&#39;</span><span class="p">:</span> <span class="n">resized</span><span class="p">})</span>
</pre></div>
</div>
<p>The first line in the above code creates a Source that reads from a
Column representing frames in a table (later, we will tell Scanner which
table to read from). The <cite>frame</cite> object it returns represents the stream of
frames that are stored in the table. On the the second line, we then process
those frames by creating an Op that will resize the frames in the <cite>frame</cite> stream
to 640x480. This Op then returns a new stream of frames which we call <cite>resized</cite>.
Finally, we write these resized frames to a column called ‘frame’ in a new table
by passing them into a Column Sink.</p>
<p>At this point, we have defined a computation graph that describes <em>what</em>
computation to run, but we haven’t yet told Scanner to run the computation
graph.</p>
</div>
<div class="section" id="defining-a-job">
<h2>Defining a Job<a class="headerlink" href="#defining-a-job" title="Permalink to this headline">¶</a></h2>
<p>To run a computation graph, we need to tell Scanner which tables we should
read and which tables we should write to (notice how when we defined the
<cite>FrameColumn</cite> source above we didn’t indicate which table to read from). This
is specified by the <em>Job</em> object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">job</span> <span class="o">=</span> <span class="n">Job</span><span class="p">(</span><span class="n">op_args</span><span class="o">=</span><span class="p">{</span>
    <span class="n">frame</span><span class="p">:</span> <span class="n">db</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;table_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;frame&#39;</span><span class="p">),</span>
    <span class="n">output_frame</span><span class="p">:</span> <span class="s1">&#39;resized_table&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Here, we say that the <cite>FrameColumn</cite> indicated by <cite>frame</cite> should read from the
column ‘frame’ in the table ‘table_name’. Similarly, we specify that the output
table indicated by <cite>output_frame</cite> should be called ‘resized_table’. In this
example, we only define one job, but Scanner can process multiple jobs at the
same time (given they use the same computation graph). When many jobs
are provided, Scanner will process them all in parallel.</p>
</div>
<div class="section" id="running-a-job">
<h2>Running a Job<a class="headerlink" href="#running-a-job" title="Permalink to this headline">¶</a></h2>
<p>Now we can run the computation graph over the video we ingested. This is done by
simply calling <cite>run</cite> on the database object, specifying the jobs and outputs
that we are interested in:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output_tables</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output_frame</span><span class="p">,</span> <span class="n">jobs</span><span class="o">=</span><span class="p">[</span><span class="n">job</span><span class="p">])</span>
</pre></div>
</div>
<p>This call will block until Scanner has finished processing the job. You should
see a progress bar while Scanner is executing the computation graph. Once the
jobs are done, <cite>db.run</cite> returns the newly computed tables, here shown as
<cite>output_tables</cite>.</p>
</div>
<div class="section" id="reading-the-results-of-a-job">
<h2>Reading the results of a Job<a class="headerlink" href="#reading-the-results-of-a-job" title="Permalink to this headline">¶</a></h2>
<p>We can directly read the results of job we just ran in our Python code by
querying the ‘frame’ column on the table ‘resized_table’:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">resized_frame</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;resized_table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;frame&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resized_frame</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>Video frames are returned as numpy arrays. Here we are printing out the shape
of the frame, which should have a width of 640 and height of 480.</p>
</div>
<div class="section" id="saving-a-video-file">
<h2>Saving a video file<a class="headerlink" href="#saving-a-video-file" title="Permalink to this headline">¶</a></h2>
<p>We can also directly save the frame column as an mp4 file by calling
<cite>save_mp4</cite> on the ‘frame’ column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;resized_table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;frame&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">save_mp4</span><span class="p">(</span><span class="s1">&#39;resized_video&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>After this call returns, an mp4 video should be saved to the current working
directory called ‘resized_video.mp4’ that consists of the resized frames
that we generated.</p>
<div class="toctree-wrapper compound">
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><!-- Copyright (c) 2018 Jeff Forcier.

     Based on original work copyright (c) 2011 Kenneth Reitz and copyright (c) 2010
     Armin Ronacher.

     Some rights reserved.

     Redistribution and use in source and binary forms of the theme, with or
     without modification, are permitted provided that the following conditions
     are met:

     * Redistributions of source code must retain the above copyright
     notice, this list of conditions and the following disclaimer.

     * Redistributions in binary form must reproduce the above
     copyright notice, this list of conditions and the following
     disclaimer in the documentation and/or other materials provided
     with the distribution.

     * The names of the contributors may not be used to endorse or
     promote products derived from this software without specific
     prior written permission.

     THIS THEME IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
     AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
     IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
     ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
     LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
     CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
     SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
     INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
     CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     ARISING IN ANY WAY OUT OF THE USE OF THIS THEME, EVEN IF ADVISED OF THE
     POSSIBILITY OF SUCH DAMAGE.
   -->

<h1 class="logo"><a href="index.html">Scanner</a></h1>



<p class="blurb">Efficient Video Analysis at Scale</p>




<p style="margin-bottom: 0px">
<a href="https://github.com/scanner-research/scanner" class="gh-btn" target="_blank" style="margin-bottom: 5px; display: inline-block;"> <span class="gh-text">View on GitHub</span> </a>
<iframe src="https://ghbtns.com/github-btn.html?user=scanner-research&repo=scanner&type=star&count=true&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
</p>



<p style="padding-bottom: 1px; margin-top: 0px; margin-bottom: 20px;">
</p><!-- Copyright (c) 2018 Jeff Forcier.

     Based on original work copyright (c) 2011 Kenneth Reitz and copyright (c) 2010
     Armin Ronacher.

     Some rights reserved.

     Redistribution and use in source and binary forms of the theme, with or
     without modification, are permitted provided that the following conditions
     are met:

     * Redistributions of source code must retain the above copyright
     notice, this list of conditions and the following disclaimer.

     * Redistributions in binary form must reproduce the above
     copyright notice, this list of conditions and the following
     disclaimer in the documentation and/or other materials provided
     with the distribution.

     * The names of the contributors may not be used to endorse or
     promote products derived from this software without specific
     prior written permission.

     THIS THEME IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
     AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
     IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
     ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
     LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
     CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
     SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
     INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
     CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     ARISING IN ANY WAY OUT OF THE USE OF THIS THEME, EVEN IF ADVISED OF THE
     POSSIBILITY OF SUCH DAMAGE.
   -->
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="getting-started.html">Getting Started</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Quickstart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#starting-up-scanner">Starting up Scanner</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ingesting-a-video-into-the-database">Ingesting a video into the Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-a-computation-graph">Defining a Computation Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-a-job">Defining a Job</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-a-job">Running a Job</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reading-the-results-of-a-job">Reading the results of a Job</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saving-a-video-file">Saving a video file</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="walkthrough.html">Interactive Jupyter Walkthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="programming-handbook.html">Programming Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation index</a><ul>
  <li><a href="getting-started.html">Getting Started</a><ul>
      <li>Previous: <a href="getting-started.html" title="previous chapter">Getting Started</a></li>
      <li>Next: <a href="walkthrough.html" title="next chapter">Interactive Jupyter Walkthrough</a></li>
  </ul></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/quickstart.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2018, Alex Poms, Will Crichton.
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
  </div>
  
  </body>
</html>